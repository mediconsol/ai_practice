# 설정(Settings) 기능 테스트 가이드

## 테스트 환경
- **개발 서버**: http://localhost:7803/
- **설정 페이지**: http://localhost:7803/settings

## 테스트 체크리스트

### 1. 프로필 설정 테스트

#### 접근
1. 사이드바에서 "설정" 메뉴 클릭
2. "프로필" 탭 확인 (기본 선택됨)

#### 테스트 항목
- [ ] 이메일이 읽기 전용으로 표시됨
- [ ] 이름 입력 필드 작동
- [ ] 소속 병원 입력 필드 작동
- [ ] 진료과/부서 입력 필드 작동
- [ ] 구독 플랜이 읽기 전용으로 표시됨
- [ ] 정보 수정 후 "변경사항 저장" 버튼 활성화
- [ ] 저장 버튼 클릭 시 성공 Toast 표시
- [ ] 저장 후 페이지 새로고침 시 변경사항 유지됨

#### 검증 방법
```
1. 이름을 "홍길동"으로 변경
2. 병원을 "서울대학교병원"으로 입력
3. 진료과를 "내과"로 입력
4. "변경사항 저장" 클릭
5. 성공 Toast 확인
6. F5로 페이지 새로고침
7. 입력한 값이 유지되는지 확인
```

---

### 2. AI 설정 테스트

#### 접근
1. "AI 설정" 탭 클릭

#### 테스트 항목
- [ ] "개발 예정 기능" 안내 메시지가 **사라짐** (Migration 완료 후)
- [ ] 기본 AI 프로바이더 선택 가능 (OpenAI/Claude/Gemini)
- [ ] OpenAI 기본 모델 선택 가능
- [ ] Claude 기본 모델 선택 가능
- [ ] Gemini 기본 모델 선택 가능
- [ ] Temperature 슬라이더 동작 (0.0 ~ 1.0)
- [ ] 최대 토큰 수 입력 가능 (100 ~ 32000)
- [ ] "변경사항 저장" 버튼 클릭 시 성공 Toast 표시
- [ ] 저장 후 새로고침 시 설정값 유지됨

#### 검증 방법
```
1. 기본 프로바이더를 "Claude"로 변경
2. Claude 모델을 "Claude 3.5 Sonnet" 선택
3. Temperature를 0.5로 조정
4. 최대 토큰을 3000으로 입력
5. "변경사항 저장" 클릭
6. 성공 Toast 확인
7. 페이지 새로고침
8. 설정값이 유지되는지 확인
```

#### Migration이 적용되지 않은 경우
- "개발 예정 기능" 메시지가 표시됨
- 모든 입력 필드가 비활성화(opacity-50)됨
- → Migration을 다시 확인하세요

---

### 3. 계정 관리 테스트

#### 접근
1. "계정" 탭 클릭

#### 테스트 항목 - 비밀번호 변경
- [ ] 새 비밀번호 입력 필드 작동
- [ ] 비밀번호 확인 입력 필드 작동
- [ ] 8자 미만 입력 시 에러 메시지 표시
- [ ] 비밀번호 불일치 시 에러 메시지 표시
- [ ] "비밀번호 변경" 버튼 클릭 시 성공 Toast 표시

#### 테스트 항목 - 계정 탈퇴
- [ ] "위험 구역" 섹션 표시됨
- [ ] "계정 탈퇴" 버튼이 빨간색(destructive)
- [ ] 버튼 클릭 시 확인 다이얼로그 표시
- [ ] 다이얼로그에 경고 메시지 표시
- [ ] "취소" 버튼으로 다이얼로그 닫기 가능
- [ ] ⚠️ "영구 삭제" 버튼 테스트는 주의 (실제로 계정이 삭제됨)

#### 검증 방법 (비밀번호 변경)
```
1. 새 비밀번호에 "short" 입력 → 에러 확인
2. 새 비밀번호에 "newpassword123" 입력
3. 확인에 "different" 입력 → 불일치 에러 확인
4. 확인에 "newpassword123" 입력
5. "비밀번호 변경" 클릭
6. 성공 Toast 확인
```

---

### 4. 데이터 관리 테스트

#### 접근
1. "데이터" 탭 클릭

#### 테스트 항목 - 데이터 통계
- [ ] 실행 결과 개수 표시
- [ ] 저장된 프롬프트 개수 표시
- [ ] 실행 히스토리 개수 표시

#### 테스트 항목 - 데이터 내보내기
- [ ] "데이터 내보내기" 버튼 클릭 시 JSON 파일 다운로드
- [ ] 다운로드된 파일명 형식: `mediconsol-data-YYYY-MM-DD.json`
- [ ] JSON 파일에 results, prompts, history 데이터 포함
- [ ] JSON 파일에 통계 정보 포함

#### 테스트 항목 - 데이터 삭제
- [ ] 각 데이터 유형별 삭제 버튼 표시
- [ ] 데이터가 없으면 삭제 버튼 비활성화
- [ ] 삭제 버튼 클릭 시 확인 다이얼로그 표시
- [ ] 다이얼로그에 경고 메시지 표시
- [ ] "취소" 버튼으로 삭제 취소 가능
- [ ] ⚠️ "삭제" 버튼은 실제로 데이터를 삭제함 (주의)

#### 검증 방법 (데이터 내보내기)
```
1. "데이터 내보내기" 버튼 클릭
2. 파일 다운로드 확인
3. JSON 파일 열어서 구조 확인:
   {
     "exported_at": "2025-12-25T...",
     "user_email": "user@example.com",
     "data": {
       "results": [...],
       "prompts": [...],
       "history": [...]
     },
     "stats": {
       "total_results": 10,
       "total_prompts": 5,
       "total_history": 15
     }
   }
```

---

### 5. UI/UX 테스트

#### 레이아웃
- [ ] 탭 전환이 부드럽게 동작
- [ ] 모바일에서 탭 라벨 축약 표시 (아이콘만)
- [ ] 데스크톱에서 탭 라벨 전체 표시

#### 반응형
- [ ] 모바일(< 640px): 1-column 레이아웃
- [ ] 데스크톱(≥ 640px): 2-column 레이아웃
- [ ] 사이드바 호버 시 확장/축소 동작

#### 피드백
- [ ] 저장 성공 시 초록색 Toast 표시
- [ ] 에러 발생 시 빨간색 Toast 표시
- [ ] 로딩 중에는 버튼에 스피너 표시
- [ ] 로딩 중에는 버튼 비활성화

---

## 일반적인 문제 해결

### 1. "개발 예정 기능" 메시지가 사라지지 않음
**원인**: Migration이 적용되지 않음
**해결**:
```sql
-- Supabase Dashboard > SQL Editor에서 실행
SELECT column_name FROM information_schema.columns
WHERE table_name = 'profiles' AND column_name = 'preferences';

-- 결과가 없으면 Migration 다시 실행
```

### 2. 저장 후 설정이 유지되지 않음
**원인**: React Query 캐시 문제
**해결**:
1. 브라우저 캐시 삭제 (Cmd+Shift+R / Ctrl+Shift+R)
2. 개발자 도구 > Application > Clear storage

### 3. Toast 알림이 표시되지 않음
**원인**: Toaster 컴포넌트 누락
**확인**: `App.tsx`에 `<Toaster />` 컴포넌트 있는지 확인

### 4. 프로필 데이터가 로드되지 않음
**원인**: 로그인 세션 만료
**해결**: 로그아웃 후 다시 로그인

---

## 성공 기준

모든 테스트 항목이 통과하면 설정 기능 구현 완료:

- ✅ 프로필 정보 수정 및 저장 가능
- ✅ AI 환경설정 변경 및 저장 가능
- ✅ 비밀번호 변경 가능
- ✅ 데이터 내보내기 가능
- ✅ 데이터 삭제 가능
- ✅ 모든 작업에 대한 피드백 제공
- ✅ 반응형 레이아웃 정상 동작

---

## 다음 단계

설정 기능 테스트 완료 후:

1. **AI 실행 화면 연동**
   - AI 실행 시 저장된 기본 설정 적용
   - 프로바이더/모델 선택 시 기본값 표시

2. **테마 설정 추가** (선택사항)
   - 라이트/다크 모드 전환
   - Context API로 전역 상태 관리

3. **알림 설정 추가** (선택사항)
   - 이메일 알림 on/off
   - 브라우저 푸시 알림 설정

---

**작성일**: 2025-12-25
**테스트 환경**: Development (localhost:7803)
